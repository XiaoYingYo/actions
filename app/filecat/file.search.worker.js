(()=>{"use strict";var t={167:t=>{t.exports=require("worker_threads")},285:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,s){function c(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,a)}l((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const o=n(167),s=n(896);function c(t,e,n){const r=n-e,o=Buffer.alloc(r);return t.copy(o,0,e,n),o}function a(t,e,n){const r=function(t){const e={},n=t.length;for(let r=0;r<n;r++)e[t[r]]=r;return e}(e),o=t.length,s=e.length,c=o-s;let a=0;for(;a<=c;){let c=s-1;for(;c>=0&&t[a+c]===e[c];)c--;if(c<0)n.push(a),a+=a+s<o?s-r[t[a+s]]||s:1;else{const e=r[t[a+c]],n=void 0!==e?c-e:c+1;a+=Math.max(n,1)}}}let l=!1;o.parentPort.on("message",t=>r(void 0,void 0,void 0,function*(){try{switch(t.type){case 1:{const{start:e,end:n,file_path:r,query_text_buffer:f}=t;let i=0,u=Buffer.alloc(0);const p=s.openSync(r,"r"),h=2097152;let g=0;for(;i<n&&!l;){const t=Buffer.alloc(h);let e=s.readSync(p,t,0,t.length,i);if(0===e)break;i+=e,u=Buffer.concat([u,t.subarray(0,e)]),o.parentPort.postMessage({type:5,progress:(100*i/n).toFixed(0)});const r=[];if(a(u,f,r),r.length>0){for(let t=0;t<r.length;t++)r[t]+=g;o.parentPort.postMessage({type:2,find_index:r})}g+=u.length-f.length,u=c(u,u.length-f.length,u.length)}o.parentPort.postMessage({type:3}),s.closeSync(p)}break;case 4:l=!0}}catch(t){console.log(t)}}))},896:t=>{t.exports=require("fs")}},e={};(function n(r){var o=e[r];if(void 0!==o)return o.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,n),s.exports})(285)})();