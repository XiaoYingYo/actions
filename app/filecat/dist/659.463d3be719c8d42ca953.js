/*! For license information please see 659.463d3be719c8d42ca953.js.LICENSE.txt */
"use strict";(self.webpackChunkfilecat=self.webpackChunkfilecat||[]).push([[659],{3659:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var r=n(2389),a=n(6540),o=n(7444),i=n(6417),c=n(4238),l=n(4944),u=n(447),s=n(5997),f=n(2042),d=n(7952),m=n(5725),v=n(7481),p=n(3033),h=n(7071),y=n(4289),b=n(8062),E=n(7856),w=n(8815);function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=j(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function _(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return x(u,"_invoke",function(n,r,a){var o,c,l,u=0,s=a||[],f=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return o=t,c=0,l=e,d.n=n,i}};function m(n,r){for(c=n,l=r,t=0;!f&&u&&!a&&t<s.length;t++){var a,o=s[t],m=d.p,v=o[2];n>3?(a=v===r)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=m&&((a=n<2&&m<o[1])?(c=0,d.v=r,d.n=o[1]):m<v&&(a=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,d.n=v,c=0))}if(a||n>1)return i;throw f=!0,r}return function(a,s,v){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&m(s,v),c=s,l=v;(t=c<2?e:l)||!f;){o||(c?c<3?(c>1&&(d.n=-1),m(c,l)):d.n=l:d.v=l);try{if(u=2,o){if(c||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=e}else if((t=(f=d.n<0)?l:n.call(r,d))!==i)break}catch(t){o=e,c=1,l=t}finally{u=1}}return{value:t,done:f}}}(n,a,o),!0),u}var i={};function c(){}function l(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(x(t={},r,function(){return this}),t),f=u.prototype=c.prototype=Object.create(s);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,x(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=u,x(f,"constructor",u),x(u,"constructor",l),l.displayName="GeneratorFunction",x(u,a,"GeneratorFunction"),x(f),x(f,a,"Generator"),x(f,r,function(){return this}),x(f,"toString",function(){return"[object Generator]"}),(k=function(){return{w:o,m:d}})()}function x(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}x=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var o=function(t,n){x(e,t,function(e){return this._invoke(t,n,e)})};o("next",0),o("throw",1),o("return",2)}},x(e,t,n,r)}function S(e,t,n,r,a,o,i){try{var c=e[o](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,a)}function A(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){S(o,r,a,i,c,"next",e)}function c(e){S(o,r,a,i,c,"throw",e)}i(void 0)})}}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return O(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var M,N,I=a.lazy(function(){return n.e(614).then(n.bind(n,5614))}),F=-1;function P(e){var t=(0,r.Bd)().t,n=C((0,o.L4)(i.A.workflow_show),2),x=(n[0],n[1]),S=C((0,a.useState)([]),2),j=S[0],O=S[1],P=C((0,a.useState)([]),2),G=P[0],T=P[1],X=C((0,a.useState)(!1),2),q=X[0],z=X[1],B=C((0,a.useState)(void 0),2),J=B[0],$=B[1],D=C((0,a.useState)([]),2),H=D[0],K=D[1],W=C((0,a.useState)(-1),2),U=W[0],V=W[1],Z=C((0,a.useState)(10),2),L=Z[0],Q=(Z[1],C((0,a.useState)(0),2)),R=(Q[0],Q[1]),Y=C((0,a.useState)(0),2),ee=Y[0],te=Y[1],ne=C((0,a.useState)(""),2),re=ne[0],ae=ne[1],oe=C((0,a.useState)(!1),2),ie=oe[0],ce=oe[1],le=[t("序号"),t("运行名称"),t("状态"),t("运行时长"),t("日期"),t("操作")],ue=[t("名称"),t("状态"),t("cwd"),t("运行时长"),t("操作")],se=function(){var e=A(k().m(function e(t){var n,r,a;return k().w(function(e){for(;;)switch(e.n){case 0:return(n=new h._).page_num=null!=t?t:U,n.page_size=L,n.dir_path="".concat((0,y.GG)("file",(0,y.vX)())),e.n=1,l.ws.sendData(c.HK.workflow_get,n);case 1:if(r=e.v){e.n=2;break}return e.a(2);case 2:a=r.context,O(a.list.map(function(e){var t="string"==typeof e.meta?JSON.parse(e.meta):e.meta;return t.index=e.index,t})),R(a.total),te((0,w.gw)(a.total,L));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=A(k().m(function e(t){var n,r,a;return k().w(function(e){for(;;)switch(e.n){case 0:return(n=new h._).search_name=t,n.dir_path="".concat((0,y.GG)("file",(0,y.vX)())),ce(!0),e.n=1,l.ws.sendData(c.HK.workflow_search_by_run_name,n);case 1:if(r=e.v){e.n=2;break}return e.a(2);case 2:a=r.context,O(a.list.map(function(e){var t="string"==typeof e.meta?JSON.parse(e.meta):e.meta;return t.index=e.index,t})),R(a.total),te((0,w.gw)(a.total,L)),V(0),ce(!1);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=A(k().m(function e(){var t;return k().w(function(e){for(;;)switch(e.n){case 0:t=new E.Terminal({fontFamily:"Monaco, Menlo, Consolas, 'Courier New', monospace",theme:{background:"#FFFFFF",foreground:"#000000",cursor:"#000000",selectionBackground:"#a6d2ff"},cursorBlink:!0,cursorStyle:"bar",scrollback:1e3,scrollSensitivity:1,tabStopWidth:4,convertEol:!0}),N=t,$(t);case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)(function(){return z(!1),M=void 0,N=void 0,F=-1,se(),A(k().m(function e(){return k().w(function(e){for(;;)switch(e.n){case 0:N&&(N.dispose(),N=null);case 1:return e.a(2)}},e)}))},[]);var me=function(){var e=A(k().m(function e(t){var n,r,a,o,i,u;return k().w(function(e){for(;;)switch(e.n){case 0:if(!t.is_running){e.n=1;break}return e.a(2);case 1:return K([]),(n=new h._).index=t.index,n.dir_path="".concat((0,y.GG)("file",(0,y.vX)())),e.n=2,l.ws.sendData(c.HK.workflow_get,n);case 2:r=e.v,a=r.context,o="string"==typeof a.one_data.data?JSON.parse(a.one_data.data):a.one_data.data,i=o.success_list,u=o.fail_list,T([].concat(_(u),_(i)));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ve=function(e,t,n){if(t){var r,o=g(null!=t?t:[]);try{for(o.s();!(r=o.n()).done;){var i,c,l,s=r.value,f=void 0,d=[];if(s["use-yml"])ve(d,void 0,s.use_job_children_list),f="".concat(s["use-yml"],"  ;").concat(null!==(c=s.duration)&&void 0!==c?c:-1);else f="".concat(s.run,"  ;").concat(null!==(l=s.duration)&&void 0!==l?l:-1);f=a.createElement("div",null,a.createElement(u.fq,{success:void 0===s.code?void 0:0===s.code}),"$",f),e.push({name:f,children:d,extra_data:{code:s.code,context:null!==(i=s.success_message)&&void 0!==i?i:s.fail_message}})}}catch(e){o.e(e)}finally{o.f()}}else if(n){var m,v=g(null!=n?n:[]);try{for(v.s();!(m=v.n()).done;){var p=m.value,h=a.createElement("div",null,a.createElement(u.fq,{success:void 0===p.code?void 0:0===p.code}),"$",p.name);e.push({name:h,extra_data:{code:p.code,is_job:!0,job_data:p}})}}catch(e){v.e(e)}finally{v.f()}}},pe=function(){var e=A(k().m(function e(t){var n,r;return k().w(function(e){for(;;)switch(e.n){case 0:n=t.steps,ve(r=[],null!=n?n:[]),K(r);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=A(k().m(function e(t){return k().w(function(e){for(;;)switch(e.n){case 0:if(N){e.n=1;break}return e.n=1,new Promise(function(e){M=e,z(!0),de()});case 1:t&&(N.reset(),N.write(t));case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=A(k().m(function e(t){var n,r,a;return k().w(function(e){for(;;)switch(e.n){case 0:if(null==t||null===(n=t.extra_data)||void 0===n||!n.is_job){e.n=2;break}return e.n=1,pe(t.extra_data.job_data);case 1:return e.a(2);case 2:if(null==t||null===(r=t.extra_data)||void 0===r||!r.context){e.n=3;break}he(t.extra_data.context),e.n=5;break;case 3:if(null!=t&&t.extra_data.code){e.n=4;break}return e.a(2);case 4:he(null!==(a=t.extra_data.code)&&void 0!==a?a:"");case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return a.createElement("div",null,a.createElement(d.A,null,J&&a.createElement(s.rA,{icon:"print",title:"打印日志",onClick:function(){z(!q)}}),a.createElement(s.rA,{icon:"close",title:t("关闭"),onClick:function(){x(!1)}})),a.createElement(m.jW,{isFull:!0,more:!0},a.createElement(m.NN,null,a.createElement(m.xh,null,a.createElement(m.fI,null,a.createElement(m.VP,null,a.createElement(u.uF,{self_title:a.createElement("span",{className:" div-row "},a.createElement("h2",null,t("历史记录"))),titleCom:a.createElement("div",{className:" div-row "},a.createElement(p.Sm,{disabled:ie,value:re,placeholder:"搜索运行名称(支持正则)",handleInputChange:function(e){ae(re)},handlerEnter:function(e){fe(e)}})),rightBottomCom:a.createElement("span",{className:" div-row "},a.createElement("span",null,Math.abs(U),"/",ee),a.createElement(p.Sm,{placeholder:"max page ".concat(ee),handleInputChange:function(e){F=parseInt(e)},handlerEnter:function(){if(F<1||F>ee)(0,f.zN)("illegal page num");else{var e=0-F;V(e),se(e)}}}),a.createElement(s.rA,{icon:"navigate_before",onClick:function(){var e=U+1;e>-1?(0,f.zN)("max page num"):(V(e),se(e))},title:"上一页"}),a.createElement(s.rA,{icon:"navigate_next",onClick:function(){var e=U-1;Math.abs(e)>ee?(0,f.zN)("min page num"):(V(e),se(e))},title:"下一页"}))},a.createElement(v.X,{headers:le,rows:j.map(function(e,n){var r;return r=e.is_running?a.createElement("div",null,a.createElement(u.fq,null),t("正在运行")):a.createElement("div",null,a.createElement(u.fq,{success:e.is_success}),e.is_success?t("成功"):t("失败")),[a.createElement("p",null,e.index),a.createElement("p",{style:{wordWrap:"break-word"}},e["run-name"]),r,a.createElement("span",null,e.duration),a.createElement("span",null,e.timestamp),a.createElement("div",null,a.createElement(s.rA,{icon:"details",title:t("详情"),onClick:function(){me(e)}}))]}),width:"10rem"}))),a.createElement(m.VP,null,a.createElement(u.Zp,{title:t("Job")},a.createElement(v.X,{headers:ue,rows:G.map(function(e,n){return[a.createElement("p",null,e.name),a.createElement("div",null,a.createElement(u.fq,{success:void 0===e.code?void 0:0===e.code}),0===e.code?t("成功"):t("失败")),a.createElement(u.xP,null,e.cwd),a.createElement("span",null,e.duration),a.createElement("div",null,a.createElement(s.rA,{icon:"details",title:t("详情"),onClick:function(){pe(e)}}),(!!e.success_message||!!e.fail_message)&&a.createElement(s.rA,{icon:"print",title:t("日志"),onClick:function(){var t;he(null!==(t=e.success_message)&&void 0!==t?t:e.fail_message)}}))]}),width:"10rem"})),a.createElement(u.Zp,{title:"Step"},a.createElement(b.A,{list:H,click:function(e){ye(e)}}))))))),a.createElement("div",{style:{display:q?"":"none"}},a.createElement(I,{show:!0,terminal:J,init:function(){M&&(M(1),M=void 0)}})))}},7481:(e,t,n)=>{n.d(t,{S:()=>c,X:()=>i});var r=n(6540);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t,n=a(r.useState([]),2),o=n[0],i=n[1];return(0,r.useEffect)(function(){e.children?i(Array.isArray(e.children)?e.children:[e.children]):i(e.rows)},[e.rows,e.children]),r.createElement("table",null,r.createElement("thead",null,r.createElement("tr",null,null===(t=e.headers)||void 0===t?void 0:t.map(function(e,t){return r.createElement("th",{key:t},e)}))),r.createElement("tbody",null,o.map(function(t,n){return r.createElement("tr",{key:n,onContextMenu:function(){e.handleContextMenu&&e.handleContextMenu(t)}},t.map(function(t,n){var a;return r.createElement("td",{style:{width:null!==(a=e.width)&&void 0!==a?a:"auto"},key:n,className:n===o.length-1?"small":""},t)}))})))}function c(e){return r.createElement("div",{style:{display:e.isFlex?"flex":"block"}},e.columns.map(function(e,t){return r.createElement("div",{key:t},e)}))}},8062:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(6540);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(null,arguments)}function o(e){return r.createElement("div",{className:"black-tip",onClick:function(){e.click&&e.click(e)},onContextMenu:function(t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e.onContextMenu&&e.onContextMenu(t,e)}},e.name)}var i=function(e){return r.createElement("li",null,e.click?r.createElement(o,a({},e.node,{name:e.render?e.render(e.node):e.node.name,click:e.click,onContextMenu:e.onContextMenu})):r.createElement("div",null,e.render?e.render(e.node):e.node.name),e.node.children&&e.node.children.length>0&&r.createElement("ul",null,e.node.children.map(function(t,n){return r.createElement(i,{key:n,node:t,click:e.click,onContextMenu:e.onContextMenu,render:e.render})})))};const c=function(e){return r.createElement("div",{className:"card-tree-view"},r.createElement("ul",null,e.list&&e.list.map(function(t,n){return r.createElement(i,{key:n,node:t,click:e.click,onContextMenu:e.onContextMenu,render:e.render})})))}}}]);