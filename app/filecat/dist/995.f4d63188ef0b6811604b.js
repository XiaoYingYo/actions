/*! For license information please see 995.f4d63188ef0b6811604b.js.LICENSE.txt */
"use strict";(self.webpackChunkfilecat=self.webpackChunkfilecat||[]).push([[995],{9995:(e,t,n)=>{n.r(t),n.d(t,{default:()=>me});var r=n(6540),o=n(7022),i=n(7444),a=n(6417),l=n(7767),c=n(4694),u=n(6007),s=n(4289),f=n(8844),m=n(7567),d=n(4251),p=n(2389),v=n(8247),h=n(9214);function y(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return _(u,"_invoke",function(n,r,o){var i,l,c,u=0,s=o||[],f=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,l=0,c=e,m.n=n,a}};function d(n,r){for(l=n,c=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,i=s[t],d=m.p,p=i[2];n>3?(o=p===r)&&(c=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(l=0,m.v=r,m.n=i[1]):d<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,m.n=p,l=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,p),l=s,c=p;(t=l<2?e:c)||!f;){i||(l?l<3?(l>1&&(m.n=-1),d(l,c)):m.n=c:m.v=c);try{if(u=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(f=m.n<0)?c:n.call(r,m))!==a)break}catch(t){i=e,l=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,o,i),!0),u}var a={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(_(t={},r,function(){return this}),t),f=u.prototype=l.prototype=Object.create(s);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,_(f,"constructor",u),_(u,"constructor",c),c.displayName="GeneratorFunction",_(u,o,"GeneratorFunction"),_(f),_(f,o,"Generator"),_(f,r,function(){return this}),_(f,"toString",function(){return"[object Generator]"}),(y=function(){return{w:i,m}})()}function _(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){_(e,t,function(e){return this._invoke(t,n,e)})};i("next",0),i("throw",1),i("return",2)}},_(e,t,n,r)}function w(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,l,"next",e)}function l(e){b(i,r,o,a,l,"throw",e)}a(void 0)})}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return A(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function x(e){var t=E((0,i.L4)(a.A.selectedFileList),2),n=t[0],_=t[1],b=E((0,i.L4)(a.A.clickFileList),2),k=b[0],A=b[1],x=E((0,i.L4)(a.A.nowFileList),2),O=x[0],P=x[1],L=E((0,i.L4)(a.A.confirm),2),S=(L[0],L[1]),j=E((0,i.L4)(a.A.enterKey),2),C=j[0],G=(j[1],(0,v.kZ)().click_file),z=((0,p.Bd)().t,(0,l.Zp)()),F=((0,l.zy)(),function(){var t=g(y().m(function t(r,i){var a,l,u,f,m,d;return y().w(function(t){for(;;)switch(t.n){case 0:if(null!==(0,c.kW)(n,r))_((0,c.P1)(n,r));else if("ctrl"===C)_([].concat(w(n),[r]));else if("shift"===C){if(a=(0,c.a7)(n),l=a.max,u=a.min,f=[],r>=l)for(m=l;m<=r;m++)f.push(m);else for(d=u;d>=r;d--)f.push(d);_(f)}else _([r]);if(A([].concat(w(k),[r])),setTimeout(function(){A((0,c.P1)(k,r))},300),e.type!==o.Iw.folder){t.n=2;break}if(void 0===k.find(function(e){return e===r})){t.n=1;break}return z((0,c.IO)((0,s.vX)(),i)),_([]),A([]),P({files:[],folders:[]}),t.a(2);case 1:t.n=3;break;case 2:void 0!==k.find(function(e){return e===r})&&G({name:i,size:e.origin_size,opt_shell:!0,mtime:e.mtime});case 3:return t.a(2)}},t)}));return function(e,n){return t.apply(this,arguments)}}()),I=E((0,i.L4)(a.A.showPrompt),2),T=(I[0],I[1]),M=function(){var e=g(y().m(function e(t){var r,o;return y().w(function(e){for(;;)switch(e.n){case 0:return r=(0,h.ib)(O,n),o=r.map(function(e){return(0,h.Ok)(e.name)}),e.n=1,u.$M.post("cut",{files:o,to:"".concat((0,s.GG)("file",(0,s.vX)()),"/").concat(t)});case 1:e.v,_([]),S({open:!1,handle:null}),z((0,s.vX)());case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return r.createElement(f.B,{extraAttr:{onContextMenu:function(t){!function(e,t,n,r){e.preventDefault(),e.stopPropagation();var i=new d.i;i.path=(0,c.IO)((0,s.vX)(),t),i.filename=t,i.x=e.clientX,i.y=e.clientY,i.type=n?o.Iw.folder:(0,d.u)(t),i.size=r,T({show:!0,type:m.PromptEnum.FileMenu,overlay:!1,data:i})}(t,e.name,e.type===o.Iw.folder,e.origin_size)}},draggable_handle:M,name:e.name,index:e.index,mtime:e.mtime,size:e.size,type:e.type,isLink:e.isLink,path:e.path,icon:e.icon,show_mtime:e.show_mtime,click:F,itemWidth:e.itemWidth})}var O=n(7374),P=n(5997),L=n(7952),S=n(5726),j=n(3459),C=n(5725),G=n(3033),z=n(2042),F=n(7523),I=n(8815),T=n(2730),M=n(1251),W=n(447),X=n(7071),D=n(4944),K=n(4238),N=n(3430),U=n(2458),H=n(3496);function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R.apply(null,arguments)}function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function $(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||re(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach(function(t){q(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function q(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return J(u,"_invoke",function(n,r,o){var i,l,c,u=0,s=o||[],f=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,l=0,c=e,m.n=n,a}};function d(n,r){for(l=n,c=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,i=s[t],d=m.p,p=i[2];n>3?(o=p===r)&&(c=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(l=0,m.v=r,m.n=i[1]):d<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,m.n=p,l=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,p){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,p),l=s,c=p;(t=l<2?e:c)||!f;){i||(l?l<3?(l>1&&(m.n=-1),d(l,c)):m.n=c:m.v=c);try{if(u=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(f=m.n<0)?c:n.call(r,m))!==a)break}catch(t){i=e,l=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,o,i),!0),u}var a={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(J(t={},r,function(){return this}),t),f=u.prototype=l.prototype=Object.create(s);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,J(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,J(f,"constructor",u),J(u,"constructor",c),c.displayName="GeneratorFunction",J(u,o,"GeneratorFunction"),J(f),J(f,o,"Generator"),J(f,r,function(){return this}),J(f,"toString",function(){return"[object Generator]"}),(V=function(){return{w:i,m}})()}function J(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}J=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){J(e,t,function(e){return this._invoke(t,n,e)})};i("next",0),i("throw",1),i("return",2)}},J(e,t,n,r)}function Q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=re(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function ee(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function te(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){ee(i,r,o,a,l,"next",e)}function l(e){ee(i,r,o,a,l,"throw",e)}a(void 0)})}}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||re(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){if(e){if("string"==typeof e)return oe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ie,ae=r.lazy(function(){return Promise.all([n.e(856),n.e(659)]).then(n.bind(n,3659))}),le=r.lazy(function(){return Promise.all([n.e(856),n.e(636)]).then(n.bind(n,1636))}),ce=r.lazy(function(){return Promise.all([n.e(856),n.e(402)]).then(n.bind(n,3402))}),ue=Object.values(N.UG),se=280,fe={};function me(){var e,t,n=ne((0,i.L4)(a.A.editorSetting),2),f=(n[0],n[1]),y=ne((0,i.L4)(a.A.file_preview),2),_=(y[0],y[1]),w=(0,p.Bd)().t,b=(0,r.useRef)(null),g=(0,l.zy)(),E=(0,l.Zp)(),k=(0,v.MH)().check_user_auth,A=ne((0,i.L4)(a.A.nowFileList),2),Z=A[0],q=A[1],J=ne((0,i.L4)(a.A.uploadFiles),2),ee=(J[0],J[1]),re=ne((0,i.L4)(a.A.showPrompt),2),oe=(re[0],re[1]),me=ne((0,i.L4)(a.A.selectedFileList),2),de=me[0],pe=(me[1],ne((0,i.L4)(a.A.copyedFileList),2)),ve=pe[0],he=pe[1],ye=ne((0,i.L4)(a.A.enterKey),2),_e=(ye[0],ye[1]),we=ne((0,i.L4)(a.A.cutedFileList),2),be=we[0],ge=we[1],Ee=ne((0,i.L4)(a.A.selectedFileList),2),ke=(Ee[0],Ee[1]),Ae=ne((0,i.L4)(a.A.clickFileList),2),xe=(Ae[0],Ae[1]),Oe=ne((0,i.L4)(a.A.fileShellShow),2),Pe=Oe[0],Le=Oe[1],Se=ne((0,i.L4)(a.A.file_root_list),2),je=Se[0],Ce=(Se[1],ne((0,i.L4)(a.A.file_root_index),2)),Ge=(Ce[0],Ce[1]),ze=ne((0,r.useState)(void 0),2),Fe=ze[0],Ie=ze[1],Te=ne((0,r.useState)(""),2),Me=Te[0],We=Te[1],Xe=ne((0,i.L4)(a.A.workflow_show),2),De=Xe[0],Ke=Xe[1],Ne=ne((0,i.L4)(a.A.workflow_realtime_show),2),Ue=Ne[0],He=(Ne[1],ne((0,r.useState)(!1),2)),Re=He[0],Ye=He[1],$e=(0,r.useContext)(F.F).reloadUserInfo,Ze=(0,r.useContext)(F.F).initUserInfo,Be=ne((0,i.L4)(a.A.user_base_info),2),qe=Be[0],Ve=(Be[1],(0,v.kZ)().click_file),Je=ne((0,i.L4)(a.A.prompt_card),2),Qe=(Je[0],Je[1]),et=(0,v.hg)().file_is_running,tt=ne((0,i.L4)(a.A.to_running_files),2),nt=(tt[0],tt[1]),rt=ne((0,i.L4)(a.A.router_jump),2),ot=(rt[0],rt[1]),it=function(){var e=te(V().m(function e(){var t;return V().w(function(e){for(;;)switch(e.n){case 0:return(t=new X.Nd).dir_path="".concat((0,s.GG)("file",(0,s.vX)())),D.ws.addMsg(K.HK.workflow_realtime,function(e){var t=e.context;if(e.context){var n,r=Q(t.sucess_file_list);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.endsWith(".workflow.yml")?(0,z.LW)("".concat(o.slice(0,-13)," done!")):o.endsWith(".act")&&(0,z.LW)("".concat(o.slice(0,-4)," done!"))}}catch(e){r.e(e)}finally{r.f()}var i,a=Q(t.failed_file_list);try{for(a.s();!(i=a.n()).done;){var l=i.value;l.endsWith(".workflow.yml")?(0,z.zN)("".concat(l.slice(0,-13)," failed!")):l.endsWith(".act")&&(0,z.zN)("".concat(l.slice(0,-4)," failed!"))}}catch(e){a.e(e)}finally{a.f()}nt(new Set(t.running_file_list))}}),e.n=1,D.ws.sendData(K.HK.workflow_realtime,t);case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),at=function(){var e=te(V().m(function e(t){var n,r,o,i,a,l,c,f,m,d,p;return V().w(function(e){for(;;)switch(e.n){case 0:return t=t?encodeURIComponent(t)+"?is_sys_path=1":encodeURIComponent((0,s.GG)("file",(0,s.vX)())),e.n=1,u.$M.get(t);case 1:if((o=e.v).code!==j.m.PreFile){e.n=2;break}return Ve({name:o.message,context:o.data,opt_shell:!0}),e.a(2);case 2:if(o.code===j.m.Sucess){e.n=3;break}return o.message&&(0,z.zN)(o.message),e.a(2);case 3:i=o.data,(0,h.yC)(i,qe.user_data.dir_show_type),a=!1,l=Q(null!==(n=i.files)&&void 0!==n?n:[]);try{for(l.s();!(c=l.n()).done;)(f=c.value).show_mtime=f.mtime?(0,M.s)(f.mtime):"",f.origin_size=f.size,f.size=(0,I.v7)(f.size),a||!f.name.endsWith(".workflow.yml")&&!f.name.endsWith(".act")||(a=!0,Promise.resolve().then(function(){it()}))}catch(e){l.e(e)}finally{l.f()}if(void 0===i.relative_user_path){e.n=4;break}return(i.relative_user_path.startsWith("\\")||i.relative_user_path.startsWith("/"))&&(i.relative_user_path=i.relative_user_path.slice(1)),E(i.relative_user_path),e.a(2);case 4:a=!1,m=Q(null!==(r=i.folders)&&void 0!==r?r:[]);try{for(m.s();!(d=m.n()).done;)(p=d.value).show_mtime=p.mtime?(0,M.s)(p.mtime):"",a||p.name!==X.SB||(Ye(!0),a=!0)}catch(e){m.e(e)}finally{m.f()}q(o.data),ie=o.data;case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),lt=function(){var e=Math.floor(document.querySelector("main").offsetWidth/se);0===e&&(e=1),Ie("calc(".concat(100/e,"% - 1em)"))};(0,r.useEffect)(function(){var e=function(){var e=te(V().m(function e(){return V().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,at();case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();e(),f({open:!1}),_({open:!1}),Ye(!1),fe={}},[g]),(0,r.useEffect)(function(){return te(V().m(function e(){return V().w(function(e){for(;;)switch(e.n){case 0:nt(new Set);case 1:return e.a(2)}},e)}))},[]);var ct=function(){var e=te(V().m(function e(t){var n,r,o,i;return V().w(function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),t.stopPropagation(),n=t.dataTransfer,r=t.target,!(n.files.length<=0)){e.n=1;break}return e.a(2);case 1:for(o=0;o<5;o++)null===r||r.classList.contains("item")||(r=r.parentElement);return e.n=2,(0,S.T)(n);case 2:i=e.v,ee(i),oe({show:!0,type:m.PromptEnum.FilesUpload,overlay:!1,data:{}});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ut=function(e){e.preventDefault()};function st(){return(st=te(V().m(function e(){var t,n,r;return V().w(function(e){for(;;)switch(e.n){case 0:return r=(0,c.jH)(ue,null!==(t=null==qe||null===(n=qe.user_data)||void 0===n?void 0:n.file_list_show_type)&&void 0!==t?t:""),e.n=1,u.wm.post(H.s.user_save_user_file_list_show_type,{type:r});case 1:Ze();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function ft(e){(0,z.LW)(e)}(0,r.useEffect)(function(){var e=b.current.ownerDocument;return e.addEventListener("dragover",ut),e.addEventListener("drop",ct),lt(),window.addEventListener("resize",lt),function(){e.removeEventListener("dragover",ut),e.removeEventListener("drop",ct),window.removeEventListener("resize",lt),Pe.show&&Le({show:!1,path:""})}},[]);var mt=function(){var e=te(V().m(function e(t){return V().w(function(e){for(;;)switch(e.n){case 0:return Ge(t),e.n=1,u.$M.post("base_switch",{root_index:t});case 1:return e.n=2,$e();case 2:E("/file/"),ke([]),xe([]);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),dt=function(e){Qe({open:!0,title:w("信息"),context_div:r.createElement("div",{style:{maxWidth:"25rem"}},r.createElement(C.Yh,{left:w("挂载位置磁盘"),right:null==e?void 0:e.total_size}),r.createElement(C.Yh,{left:"".concat(w("磁盘剩余")),right:null==e?void 0:e.left_size}),r.createElement(C.Yh,{left:"".concat(w("文件系统")),right:null==e?void 0:e.fs_type}),r.createElement(C.Yh,{left:"".concat(w("文件夹数")),right:Z.folders.length}),r.createElement(C.Yh,{left:"".concat(w("文件数")),right:Z.files.length}),r.createElement(C.Yh,{left:"".concat(w("当前位置")),right:r.createElement(W.xP,{context:null==e?void 0:e.now_absolute_path})})),cancel:function(){D.ws.removeMsg(K.HK.file_info)}})},pt=function(){var e=te(V().m(function e(){var t,n;return V().w(function(e){for(;;)switch(e.n){case 0:if(fe.now_absolute_path){e.n=2;break}return D.ws.addMsg(K.HK.file_info,function(e){var n=e.context;t&&(fe=B(B({},fe),n),D.ws.removeMsg(K.HK.file_info),dt(fe))}),e.n=1,D.ws.sendData(K.HK.file_info,{type:o.Iw.folder,path:(0,s.GG)("file",(0,s.vX)())});case 1:n=e.v,t=n.context,dt(fe=t);case 2:dt(fe);case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),vt=ne((0,r.useState)(!1),2),ht=vt[0],yt=vt[1];(0,r.useEffect)(function(){var e=function(e){if(ht)if(e.ctrlKey)if("a"===e.key||"A"===e.key){for(var t=Z.files.length,n=Z.folders.length,r=[],o=0;o<t+n;o++)r.push(o);ke(r)}else _e("ctrl");else"Escape"===e.key?ke([]):"Shift"===e.key&&_e("shift")},t=function(e){e.ctrlKey||_e("")};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[Z,ht]);var _t=function(e){e.target===e.currentTarget&&ke([])};return r.createElement("div",{className:"not-select-div"},r.createElement(L.A,{left_children:r.createElement(G.$Z,{handleEnterPress:function(){var e,t;if(ie){ke([]),xe([]);var n,r=[],o=[],i=Q(null!==(e=ie.files)&&void 0!==e?e:[]);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.name.includes(Me)&&r.push(a)}}catch(e){i.e(e)}finally{i.f()}var l,c=Q(null!==(t=ie.folders)&&void 0!==t?t:[]);try{for(c.s();!(l=c.n()).done;){var u=l.value;u.name.includes(Me)&&o.push(u)}}catch(e){c.e(e)}finally{c.f()}q({files:r,folders:o})}},placeholder:w("搜索当前目录"),icon:"search",value:"",handleInputChange:function(e){We(e)},max_width:"25em"})},de.length>0&&r.createElement(P.rA,{icon:"delete",title:w("删除"),onClick:function(){oe({show:!0,type:m.PromptEnum.FilesDelete,overlay:!0,data:{}})}}),de.length>0&&r.createElement(P.rA,{icon:"content_copy",title:w("复制"),onClick:function(){var e=(0,h.ib)(Z,de);he(e.map(function(e){return(0,h.Ok)(e.name)})),ge([]),ft("已复制")}}),de.length>0&&r.createElement(P.rA,{icon:"content_cut",title:w("剪切"),onClick:function(){var e=(0,h.ib)(Z,de);ge(e.map(function(e){return(0,h.Ok)(e.name)})),he([]),ft("已剪切")}}),(ve.length>0||be.length>0)&&r.createElement(P.rA,{onClick:function(){oe({show:!0,type:m.PromptEnum.Confirm,overlay:!0,data:{}})},icon:"content_paste",title:w("粘贴到此处"),tip:ve.length+be.length}),de.length>0&&r.createElement(P.rA,{icon:"download",title:w("下载"),onClick:function(){for(var e=(0,h.ib)(Z,de),t=0;t<e.length;t++){var n=e[t];e[t]=encodeURIComponent((0,h.Ok)(n.name))}var r=u.$M.getDownloadUrl(e);window.open(r)}}),de.length>0&&r.createElement(P.rA,{icon:"compress",title:w("压缩"),onClick:function(){for(var e=(0,h.ib)(Z,de),t=0;t<e.length;t++){var n=e[t];e[t]=(0,h.Ok)(n.name)}e&&0!==e.length?oe({show:!0,type:m.PromptEnum.Compress,overlay:!0,data:{files:e}}):(0,z.zN)("没有选中")}}),1===de.length&&r.createElement(P.rA,{icon:"edit_attributes",title:w("重命名"),onClick:function(){oe({show:!0,type:m.PromptEnum.FileRename,overlay:!0,data:{}})}}),Re&&r.createElement(P.rA,{icon:"api",title:"workflow",onClick:function(){Ke(!De)}}),r.createElement(P.rA,{icon:"terminal",title:"shell",onClick:function(){Pe.show?Le({show:!1,path:""}):Le({show:!0,path:(0,s.GG)("file",(0,s.vX)())})}}),r.createElement(P.rA,{icon:"grid_view",title:w("切换样式"),onClick:function(){return st.apply(this,arguments)}}),r.createElement(P.rA,{icon:"create_new_folder",title:w("创建文件夹"),onClick:function(){oe({show:!0,type:m.PromptEnum.DirNew,overlay:!0,data:{dir:(0,s.GG)("file",(0,s.vX)())}})}}),r.createElement(P.rA,{icon:"note_add",title:w("创建文本文件"),onClick:function(){oe({show:!0,type:m.PromptEnum.FileNew,overlay:!0,data:{dir:(0,s.GG)("file",(0,s.vX)())}})}}),r.createElement(P.rA,{icon:"upload_file",title:w("上传"),onClick:function(){oe({show:!0,type:m.PromptEnum.UploadFile,overlay:!0,data:{call:function(e){var t,n=null===(t=e.currentTarget)||void 0===t?void 0:t.files;if(n){for(var r=!!n[0].webkitRelativePath,o=[],i=new Set,a=0;a<n.length;a++){var l=n[a],c=r?l.webkitRelativePath:"".concat(l.webkitRelativePath).concat(l.name);l.fullPath=c,r&&i.add((0,T.S)(c)),o.push(l)}var u=[];if(r){var s,f=Q(i);try{for(f.s();!(s=f.n()).done;){var d=s.value;u.push({isDir:!0,fullPath:d,name:d})}}catch(e){f.e(e)}finally{f.f()}}u.push.apply(u,o),ee(u),oe({show:!0,type:m.PromptEnum.FilesUpload,overlay:!1,data:{}})}}}})}}),r.createElement(P.rA,{icon:"info",title:w("信息"),onClick:pt}),r.createElement(P.rA,{icon:"more_vert",title:w("切换目录"),onClick:function(e){var t=new d.i;t.x=e.clientX,t.y=e.clientY,t.type=o.Iw.directory,t.items=je,t.textClick=function(){var e=te(V().m(function e(t){return V().w(function(e){for(;;)switch(e.n){case 0:mt(t),oe({data:void 0,overlay:!1,type:"",show:!1});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),oe({show:!0,type:m.PromptEnum.FileMenu,overlay:!1,data:t})}})),r.createElement(O.e,{baseRoute:"file",clickFun:function(){ke([]),xe([])},input_path_enter:function(e){(0,U.Z1)(e)?at(e):E((0,U.Jn)((0,s.vX)(),e)),ke([]),xe([]),q({files:[],folders:[]})}}),r.createElement("div",{onContextMenu:function(e){var t;e.preventDefault(),e.stopPropagation();var n=new d.i;n.x=e.clientX,n.y=e.clientY,n.type=o.Iw.directory;var i=[{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.time_minx_max?"green":void 0}},w("时间逆序")),v:N.t8.time_minx_max},{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.time_max_min?"green":void 0}},w("时间顺序")),v:N.t8.time_max_min}],a=[{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.size_min_max?"green":void 0}},w("大小逆序")),v:N.t8.size_min_max},{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.size_max_min?"green":void 0}},w("大小顺序")),v:N.t8.size_max_min}],l=[{r:w("文件排序"),v:"",items:[{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type?void 0:"green"}},w("系统默认")),v:N.t8.defualt},{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.name?"green":void 0}},w("名字")),v:N.t8.name},{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.time_minx_max||qe.user_data.dir_show_type===N.t8.time_max_min?"green":void 0}},w("修改时间")),v:!1,items:i},{r:r.createElement("span",{style:{color:qe.user_data.dir_show_type===N.t8.size_min_max||qe.user_data.dir_show_type===N.t8.size_max_min?"green":void 0}},w("文件大小")),v:!1,items:a}]}];if(k(N.oV.code_resource)&&l.push({r:w("添加http资源根目录"),v:"code_resource"}),k(N.oV.http_proxy)&&l.push({r:w("在此目录下载http资源"),v:"http_resource"}),null!=qe&&null!==(t=qe.user_data)&&void 0!==t&&t.quick_cmd){var c={r:w("快捷命令"),v:"",items:[]};(0,h.LL)($(qe.user_data.quick_cmd),c.items),l.push(c)}n.items=l,n.textClick=function(){var e=te(V().m(function e(t){var n,r,o;return V().w(function(e){for(;;)switch(e.n){case 0:if(!1!==t){e.n=1;break}return e.a(2);case 1:if("code_resource"!==t){e.n=3;break}return e.n=2,D.ws.sendData(K.HK.file_info,{path:(0,s.GG)("file",(0,s.vX)())});case 2:return n=e.v,ot({page_self_router_api_data:["",n.context.now_absolute_path]}),oe({data:void 0,overlay:!1,type:"",show:!1}),E("/setting/customer_router/"),e.a(2);case 3:if("http_resource"!==t){e.n=5;break}return e.n=4,D.ws.sendData(K.HK.file_info,{path:(0,s.GG)("file",(0,s.vX)())});case 4:return r=e.v,ot({http_download_map_path:r.context.now_absolute_path}),oe({data:void 0,overlay:!1,type:"",show:!1}),E("/proxy/http/"),e.a(2);case 5:"object"===Y(t)&&"quick_cmd"===t.tag&&(o=t.cmd)&&(o.endsWith("\r")||(o+="\r",Le({show:!0,path:(0,s.GG)("file",(0,s.vX)()),cmd:o})));case 6:return e.n=7,u.wm.post(H.s.user_save_user_file_list_show_type,{type:t,is_dir_list_type:!0});case 7:return e.n=8,Ze();case 8:oe({data:void 0,overlay:!1,type:"",show:!1}),E((0,s.vX)());case 9:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),oe({show:!0,type:m.PromptEnum.FileMenu,overlay:!1,data:n})},id:"listing",style:{paddingBottom:"10rem"},className:"mosaic file-icons ".concat(null!==(e=null==qe||null===(t=qe.user_data)||void 0===t?void 0:t.file_list_show_type)&&void 0!==e?e:""),ref:b,onMouseEnter:function(){yt(!0)},onMouseLeave:function(){yt(!1)}},Z.folders&&Z.folders.length>0&&r.createElement("h2",null,w("文件夹")),Z.folders&&r.createElement("div",{onClick:_t},Z.folders.map(function(e,t){return r.createElement(x,R({itemWidth:Fe,index:t,key:t},e))})),Z.files&&Z.files.length>0&&r.createElement("h2",{onClick:_t},w("文件")),Z.files&&r.createElement("div",{onClick:_t},Z.files.map(function(e,t){return r.createElement(x,R({icon:et(e.name)?"refresh":void 0,itemWidth:Fe,index:t+Z.folders.length,key:t},e))}))),r.createElement(ce,null),De&&r.createElement(ae,null),Ue.open&&r.createElement(le,null))}}}]);